#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🚀 Exécution des vérifications avant commit..."

# Vérifier la qualité du code backend
if [ -d "backend" ]; then
  echo "🔍 Vérification du code backend..."
  cd backend
  mvn checkstyle:check
  if [ $? -ne 0 ]; then
    echo "❌ Échec de la vérification du code backend"
    exit 1
  fi
  cd ..
fi

# Vérifier la qualité du code frontend
if [ -d "frontend" ]; then
  echo "🔍 Vérification du code frontend..."
  cd frontend
  npm run format:check
  if [ $? -ne 0 ]; then
    echo "❌ Échec de la vérification du formatage du frontend"
    exit 1
  fi
  
  npm run lint
  if [ $? -ne 0 ]; then
    echo "❌ Échec de l'analyse statique du frontend"
    exit 1
  fi
  cd ..
fi

echo "✅ Toutes les vérifications sont passées avec succès !"
exit 0
